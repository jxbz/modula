Search.setIndex({"docnames": ["bad-scaling", "faq", "golden-rules", "history", "index", "theory/atom/conv2d", "theory/atom/embed", "theory/atom/index", "theory/atom/linear", "theory/bond/index", "theory/bond/nonlinearities", "theory/compound/gpt", "theory/compound/index", "theory/module", "theory/vector"], "filenames": ["bad-scaling.rst", "faq.rst", "golden-rules.rst", "history.rst", "index.rst", "theory/atom/conv2d.rst", "theory/atom/embed.rst", "theory/atom/index.rst", "theory/atom/linear.rst", "theory/bond/index.rst", "theory/bond/nonlinearities.rst", "theory/compound/gpt.rst", "theory/compound/index.rst", "theory/module.rst", "theory/vector.rst"], "titles": ["Bad scaling", "Frequently asked questions", "Golden rules for scaling", "The science of scale", "Welcome to the Modula docs!", "Conv2d", "Embedding", "Atomic modules", "Linear", "Bond modules", "Nonlinearities", "GPT", "Compound modules", "Modules", "Vectors"], "terms": {"At": [0, 2], "simplest": [0, 1], "level": [0, 3], "neural": [0, 1, 2, 3, 4], "network": [0, 1, 2, 3, 4], "ar": [0, 1, 2], "train": [0, 1, 2], "iter": [0, 2], "follow": [0, 2, 3], "oper": [0, 1, 2, 3], "weight": [0, 1, 2, 3], "learning_r": [0, 2], "gradient": [0, 1, 2, 3], "where": [0, 1, 2, 3], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "float": [0, 2], "loss": [0, 1, 2], "function": [0, 1, 2], "respect": [0, 1, 2], "Of": 0, "cours": [0, 2], "practic": [0, 1, 2, 3], "we": [0, 1, 2, 3, 4], "mai": [0, 1, 2, 3], "want": [0, 1, 2], "us": [0, 1, 2, 3, 4], "addit": [0, 1], "trick": 0, "momentum": [0, 2], "let": [0, 1, 2], "": [0, 1, 2, 3], "ignor": 0, "detail": 0, "like": [0, 1], "now": [0, 1, 2, 3], "unfortun": 0, "thi": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "simpl": [0, 2, 4], "descent": [0, 1, 2, 3], "doe": [0, 1, 2], "well": [0, 1, 3], "up": [0, 1, 3, 4], "architectur": [0, 1, 2], "what": [0, 1, 2, 3], "mean": [0, 1, 2], "suppos": [0, 1], "befor": 0, "grow": 0, "increas": [0, 2, 3], "its": [0, 1, 2], "width": [0, 3], "number": [0, 2], "neuron": 0, "layer": [0, 1, 3], "depth": [0, 1, 3], "In": [0, 1, 2, 3], "might": [0, 2], "other": [0, 2], "dimens": [0, 1, 2], "residu": [0, 1, 2], "block": [0, 1, 2], "transform": [0, 1, 2], "stick": 0, "simplifi": [0, 3], "pictur": 0, "under": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "can": [0, 1, 2, 3, 4], "break": 0, "two": [0, 1, 3], "main": [0, 1, 2, 3], "wai": [0, 1, 2], "The": [0, 1], "first": [0, 2, 3, 4], "problem": [0, 2], "optim": [0, 1, 3, 4], "learn": [0, 1, 2, 3, 4], "rate": [0, 1, 2, 3, 4], "drift": 0, "certain": [0, 1], "becaus": [0, 1, 2], "need": [0, 2], "re": [0, 1, 3], "tune": 0, "thing": [0, 1], "which": [0, 1, 2, 3], "expens": 0, "time": [0, 1], "consum": 0, "second": [0, 2, 3], "sometim": [0, 1], "perform": [0, 1, 2], "actual": [0, 1, 3], "get": [0, 1, 2], "wors": [0, 2], "even": [0, 2], "remain": 0, "stabl": [0, 1, 2], "grew": 0, "hope": [0, 2, 4], "make": [0, 1, 2, 3, 4], "better": [0, 1], "These": [0, 1], "cartoon": 0, "illustr": [0, 2], "typic": 0, "behaviour": 0, "On": [0, 2, 3], "left": [0, 1], "right": [0, 1, 2], "deterior": 0, "good": [0, 1, 2], "new": [0, 2], "have": [0, 1, 2, 3], "develop": [0, 3], "machineri": [0, 3], "larg": [0, 1, 2, 4], "solv": [0, 3], "woe": 0, "It": [0, 1, 2, 3], "turn": [0, 1, 2, 3], "out": [0, 1, 2, 3, 4], "defin": 0, "initi": [0, 1, 2], "along": [0, 1], "special": 0, "normal": [0, 1, 2, 3], "act": 0, "lead": [0, 1, 3], "algorithm": 0, "remov": [0, 1], "caus": [0, 2], "improv": [0, 4], "modula": [0, 1, 2, 3], "automat": [0, 1, 3, 4], "infer": 0, "necessari": [0, 1], "from": [0, 2, 3], "so": [0, 1, 2, 3], "user": 0, "focu": 0, "write": [0, 1, 3], "while": [0, 1, 2], "handl": 0, "properli": [0, 1], "doc": [0, 3], "intend": [0, 3], "explain": [0, 2, 3, 4], "how": [0, 1, 2, 3], "work": [0, 1, 2, 3], "also": [0, 1, 2, 3, 4], "introduc": [0, 2], "api": 0, "case": [0, 2], "you": [0, 1, 2, 3, 4], "don": [0, 1, 2], "t": [0, 1, 2, 3], "care": [0, 3], "about": [0, 1, 2, 3], "next": [0, 2], "section": [0, 1, 2], "manual": 0, "differ": [0, 1, 2], "framework": [0, 1, 2, 4], "pytorch": 0, "jax": 0, "feel": 1, "free": [1, 2], "reach": [1, 2, 3, 4], "start": [1, 2, 4], "github": [1, 4], "issu": [1, 4], "ani": [1, 2, 3], "ll": 1, "post": 1, "answer": [1, 2], "common": 1, "page": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "vector": [1, 2, 3], "spectral": [1, 2, 3], "norm": [1, 2, 3, 4], "an": [1, 2, 3], "import": [1, 2, 3], "mental": 1, "jump": [1, 4], "think": [1, 2], "our": [1, 2, 3, 4], "list": [1, 2], "tensor": [1, 2], "mathbf": [1, 3], "w": [1, 3], "_1": 1, "dot": 1, "_l": 1, "_k": 1, "k": 1, "sens": 1, "mathcal": 1, "l": [1, 2, 3], "text": [1, 3], "th": 1, "itself": 1, "being": 1, "nabla_": 1, "w_k": 1, "same": [1, 2], "shape": [1, 2], "meaningfulli": 1, "contrast": 1, "approach": [1, 2], "theori": [1, 3, 4], "whole": 1, "space": [1, 2], "flatten": 1, "one": [1, 2, 3], "big": 1, "correspond": [1, 2], "thu": 1, "lose": 1, "structur": [1, 3], "why": [1, 2, 3], "adam": [1, 2], "beat": 1, "sgd": 1, "fix": 1, "some": [1, 2, 3], "research": [1, 3, 4], "challeng": 1, "deep": [1, 2, 3, 4], "certainli": 1, "choic": 1, "languag": 1, "model": 1, "much": [1, 2], "than": [1, 2, 3], "still": [1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "wide": 1, "known": 1, "here": [1, 2], "aim": 1, "provid": 1, "mechanist": 1, "explan": 1, "reason": 1, "basic": [1, 2, 3], "idea": [1, 2, 3], "raw": 1, "should": [1, 2], "rel": 1, "size": [1, 2, 3], "across": [1, 2, 3, 4], "And": [1, 2, 3], "major": [1, 3], "rebal": 1, "updat": [1, 2, 3], "give": 1, "concret": 1, "exampl": [1, 2], "see": [1, 3], "consid": [1, 2, 4], "machin": 1, "Then": [1, 4], "vanilla": 1, "given": 1, "eta": 1, "global": 1, "toi": 1, "f": 1, "x": [1, 2], "1": [1, 2, 3], "frac": [1, 2, 3], "w_": 1, "2": [1, 2], "w_1": 1, "consist": 1, "read": [1, 4], "matric": [1, 2, 3], "_0": 1, "each": [1, 2], "depress": 1, "factor": [1, 2], "includ": [1, 2], "limit": [1, 2, 3], "advoc": 1, "inclus": 1, "sqrt": [1, 2, 3], "standard": [1, 2, 3], "do": [1, 2, 3], "nonlinear": 1, "simplic": 1, "point": [1, 2], "thei": [1, 2], "take": [1, 2, 3], "essenti": [1, 3], "appli": [1, 2, 3], "_2": 1, "_3": 1, "_": [1, 3], "0": [1, 2], "word": 1, "kill": 1, "comparison": 1, "If": [1, 3, 4], "depend": 1, "set": [1, 2], "stuck": 1, "between": [1, 2, 3], "sever": 1, "middl": [1, 2], "over": [1, 2], "input": [1, 2], "output": [1, 2], "individu": [1, 2], "effect": 1, "form": [1, 2], "modular": [1, 4], "rebalanc": 1, "base": [1, 2, 3], "transfer": [1, 3, 4], "scale": [1, 4], "By": [1, 2], "definit": 1, "modul": 1, "mathsf": 1, "m": 1, "when": [1, 2, 3], "delta": [1, 3], "cdot": 1, "y": 1, "behav": [1, 2], "complic": 1, "gpt": [1, 2], "independ": 1, "A": [1, 2, 3], "littl": [1, 2, 3], "bit": [1, 3], "more": [1, 2, 3, 4], "formal": 1, "lipschitz": 1, "leq": 1, "inequ": 1, "hold": [1, 2], "tightli": 1, "dure": [1, 2, 3], "approxim": 1, "approx": 1, "fulli": [1, 2], "therefor": [1, 2], "control": [1, 2, 3], "chang": [1, 2, 3], "statement": [1, 2], "all": [1, 2, 3], "sinc": [1, 2], "recurs": [1, 2], "submodul": 1, "desir": 1, "properti": [1, 2, 3], "extend": [1, 2], "overal": 1, "compound": 1, "gut": 1, "found": [1, 2], "lot": 1, "multipli": [1, 2], "For": [1, 2], "product": 1, "u": [1, 2, 3, 4], "top": [1, 2], "v": [1, 2], "matrix": [1, 2, 3], "b": [1, 3], "insid": 1, "know": [1, 2], "predict": 1, "otherwis": 1, "friendli": 1, "n": 1, "dimension": [1, 2], "symbol": 1, "denot": 1, "euclidean": [1, 2], "length": [1, 2, 3], "ell_2": 1, "cauchi": 1, "schwarz": 1, "tight": 1, "opposit": 1, "direct": [1, 2, 3], "configur": 1, "gener": [1, 3], "higer": 1, "order": [1, 2, 3], "relev": 1, "li": 1, "singular": [1, 2], "subspac": 1, "sub": [1, 2], "multipl": 1, "sai": [1, 2], "matter": 1, "quit": [1, 2, 3], "slack": 1, "randomli": 1, "orient": 1, "But": [1, 2], "central": 1, "tenet": [1, 2], "after": [1, 2, 3], "ha": [1, 2, 3], "suffici": 1, "warm": [1, 2], "fall": [1, 2], "state": [1, 2], "type": [1, 2], "mention": 1, "variou": 1, "quantiti": [1, 2], "outlin": 1, "captur": 1, "whether": 1, "govern": 1, "measur": 1, "expon": 1, "parameter": [1, 3], "coupl": 1, "rank": [1, 2], "find": 1, "paper": [1, 2, 3], "obviou": 1, "bear": 1, "empir": [1, 3], "test": 1, "describ": 1, "valuabl": 1, "futur": [1, 3], "involv": [1, 2, 3], "max": 1, "packag": 1, "come": 1, "soon": 1, "uniqu": 1, "\u03bcp": 1, "orthogon": [1, 2], "intial": 1, "No": 1, "could": 1, "atom": 1, "gaussian": [1, 2], "choos": [1, 2], "easier": [1, 3], "random": [1, 2, 3], "alwai": [1, 2], "entri": [1, 2], "wise": 1, "varianc": [1, 2], "sigma": [1, 2], "difficult": [1, 2], "benign": 1, "valu": [1, 2], "hand": 1, "averag": 1, "subtl": [1, 2], "numer": 1, "support": 1, "share": 1, "Not": 1, "yet": 1, "although": [1, 3], "plan": 1, "implement": [1, 3], "your": 2, "huh": [2, 4], "too": 2, "boil": 2, "down": 2, "few": 2, "principl": [2, 3], "algebra": 2, "bad": 2, "requir": 2, "unlearn": 2, "concept": 2, "been": [2, 3], "taught": 2, "lectur": 2, "activ": 2, "unit": 2, "101": 2, "intern": 2, "compar": 2, "step": 2, "understand": [2, 3], "deviat": 2, "class": [2, 3], "def": 2, "__init__": 2, "self": 2, "fan_out": 2, "int": 2, "fan_in": 2, "torch": 2, "randn": 2, "forward": 2, "return": 2, "matmul": 2, "most": [2, 3], "conduct": 2, "reduct": 2, "e": 2, "smaller": 2, "happen": [2, 3], "final": 2, "classifi": 2, "fact": 2, "studi": [2, 3], "larger": 2, "null": 2, "huge": 2, "map": 2, "zero": 2, "least": 2, "lie": 2, "nullspac": 2, "pick": 2, "compon": 2, "situat": 2, "align": 2, "non": 2, "chose": 2, "far": 2, "hindsight": 2, "blow": 2, "onli": 2, "solut": 2, "instead": [2, 3], "assumpt": [2, 3], "small": 2, "fine": 2, "quickli": 2, "nice": 2, "bonu": 2, "show": [2, 3], "switch": 2, "init": 2, "trivial": 2, "previou": 2, "style": [2, 4], "beyond": 2, "distil": 2, "call": [2, 3], "largest": 2, "carefulli": 2, "keep": 2, "mind": 2, "design": [2, 4], "worth": 2, "expand": 2, "comput": 2, "linalg": 2, "svd": 2, "tend": 2, "row": 2, "diagon": 2, "sourc": 2, "net": 2, "preced": 2, "head": 2, "tail": 2, "both": [2, 4], "through": [2, 3], "backpropag": 2, "kind": 2, "everi": [2, 3], "rest": 2, "alreadi": [2, 3], "enough": 2, "roughli": 2, "interv": 2, "equival": [2, 3], "math": [2, 3], "To": 2, "achiev": 2, "tell": 2, "One": 2, "check": [2, 4], "proport": 2, "intuit": 2, "convert": [2, 3], "spit": [2, 3], "clever": 2, "reparameter": 2, "reparameterizedlinear": 2, "empti": 2, "nn": 2, "orthogonal_": 2, "convers": 2, "correct": 2, "easi": 2, "just": [2, 3], "exactli": 2, "experi": 2, "hyperparamet": [2, 3], "As": 2, "them": 2, "grad": 2, "spectral_norm": 2, "replac": 2, "express": 2, "option": 2, "decai": 2, "often": 2, "frobenius_norm": 2, "low": 2, "look": 2, "3": 2, "resnet": 2, "residue_list": 2, "block_multipli": 2, "loop": 2, "ad": 2, "ensur": 2, "contribut": [2, 3], "allow": 2, "veri": 2, "without": [2, 3], "question": 2, "third": 2, "len": 2, "add": 2, "total": 2, "sum": 2, "divid": 2, "similar": 2, "seen": 2, "mathrm": 2, "though": 2, "term": [2, 4], "prevent": 2, "link": 2, "analogi": 2, "back": [2, 3], "plai": 2, "role": 2, "safe": 2, "equal": 2, "long": 2, "accord": 2, "4": 2, "convention": 2, "done": 2, "lambda": 2, "assum": 2, "uncorrel": 2, "expect": 2, "becom": 2, "spell": 2, "clearli": 2, "convent": 2, "wisdom": 2, "someth": [2, 4], "logic": 2, "associ": 2, "scalabl": [2, 3, 4], "simpler": [2, 3], "anyth": 2, "variabl": 2, "object": 2, "vein": 2, "obviat": 2, "histori": 2, "behind": 2, "move": 2, "autom": 2, "applic": 2, "mathemat": [2, 3], "analogu": 2, "outer": 2, "mlp": 2, "seem": [2, 3], "10": 2, "propos": [2, 3], "smooth": 2, "infinit": [2, 3], "mani": [2, 3], "best": 2, "knowledg": 2, "natur": 2, "directli": 2, "inspir": [2, 3], "taken": 3, "twist": 3, "interest": 3, "particip": 3, "subfield": 3, "purpos": 3, "present": 3, "reader": 3, "llm": 3, "histor": 3, "perspect": 3, "wa": 3, "written": [3, 4], "jeremi": [3, 4], "potenti": 3, "bias": 3, "hi": 3, "view": 3, "miss": 3, "piec": 3, "relat": 3, "would": 3, "love": 3, "either": 3, "made": 3, "pull": [3, 4], "request": [3, 4], "email": [3, 4], "my": 3, "internship": 3, "nvidia": 3, "2019": 3, "instabl": 3, "biggan": 3, "arash": 3, "vahdat": 3, "ming": 3, "yu": 3, "liu": [3, 4], "perturb": 3, "linear": 3, "stabil": 3, "learnt": 3, "topic": 3, "senthil": 3, "todadri": 3, "graduat": 3, "quantum": 3, "mechan": 3, "mit": 3, "took": 3, "undergrad": 3, "2015": 3, "continu": 3, "caltech": 3, "phd": 3, "advisor": 3, "yisong": 3, "yue": 3, "end": 3, "distanc": 3, "bernstein": [3, 4], "neurip": 3, "2020": 3, "contain": 3, "core": 3, "particular": 3, "amount": 3, "induc": 3, "featur": 3, "shift": 3, "emphasis": 3, "version": 3, "account": 3, "composit": 3, "short": 3, "anticip": 3, "unlock": 3, "workflow": 3, "deeper": 3, "complex": 3, "three": 3, "minut": 3, "youtub": 3, "video": 3, "anoth": 3, "lai": 3, "peopl": 3, "year": [3, 4], "wrote": [3, 4], "arxiv": [3, 4], "2002": 3, "03432": 3, "greg": 3, "yang": [3, 4], "edward": 3, "hu": 3, "signific": 3, "further": 3, "j": 3, "icml": 3, "2021": 3, "argument": 3, "via": 3, "deriv": 3, "parameteris": 3, "maxim": 3, "arguabl": 3, "innov": 3, "sweep": 3, "verifi": 3, "vari": 3, "earlier": 3, "were": 3, "inaccur": 3, "condit": 3, "frobeniu": 3, "fromag": 3, "lar": 3, "team": 3, "jami": 3, "simon": 3, "reconcil": 3, "metriz": 3, "jame": 3, "2023": 3, "substanti": 3, "streamlin": 3, "unifi": 3, "singl": 3, "formula": 3, "obtain": 3, "must": 3, "simpli": 3, "propto": 3, "mathtt": 3, "fan": 3, "_out": 3, "_in": 3, "qquad": 3, "unlik": 3, "advanc": 3, "formul": 3, "understood": 3, "inspect": 3, "anecdot": 3, "heard": 3, "hug": 3, "face": 3, "nanotron": 3, "believ": 3, "line": 3, "human": 3, "brain": 3, "reliabl": 3, "shouldn": 3, "artifici": 3, "system": 3, "organ": 3, "pursu": 3, "agenda": 3, "recent": 3, "minim": 3, "analyt": 3, "chri": 3, "mingard": 3, "kevin": 3, "huang": 3, "navid": 3, "azizan": 3, "surprisingli": 3, "slower": 3, "techniqu": 3, "abandon": 3, "focus": 3, "grace": 4, "instal": 4, "run": 4, "pip": 4, "intent": 4, "clear": 4, "help": 4, "speed": 4, "unclear": 4, "faq": 4, "everyon": 4, "arrow": 4, "kei": 4, "around": 4, "side": 4, "panel": 4, "prefer": 4, "academ": 4, "articl": 4, "author": 4, "tim": 4, "minyoung": 4, "hyojin": 4, "bahng": 4, "phillip": 4, "isola": 4, "titl": 4, "journal": 4, "2405": 4, "14813": 4, "2024": 4, "thank": 4, "gavia": 4, "grai": 4, "uzai": 4, "girit": 4, "jyo": 4, "pari": 4, "feedback": 4, "construct": [5, 6, 7, 8, 9, 10, 11, 12, 13, 14]}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"bad": 0, "scale": [0, 2, 3], "frequent": 1, "ask": 1, "question": 1, "other": 1, "notion": 1, "align": 1, "golden": 2, "rule": 2, "The": [2, 3], "linear": [2, 8], "layer": 2, "three": 2, "fix": 2, "width": 2, "depth": 2, "kei": 2, "queri": 2, "dot": 2, "product": 2, "wrap": 2, "up": 2, "scienc": 3, "warn": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "pre": 3, "histori": 3, "\u03bcp": 3, "enter": 3, "chat": 3, "truth": 3, "reconcili": 3, "autom": 3, "train": 3, "welcom": 4, "modula": 4, "doc": 4, "purpos": 4, "navig": 4, "companion": 4, "paper": 4, "acknowledg": 4, "conv2d": 5, "embed": 6, "atom": 7, "modul": [7, 9, 12, 13], "bond": 9, "nonlinear": 10, "gpt": 11, "compound": 12, "vector": 14}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 57}, "alltitles": {"Bad scaling": [[0, "bad-scaling"]], "Frequently asked questions": [[1, "frequently-asked-questions"]], "Other notions of alignment": [[1, null]], "Golden rules for scaling": [[2, "golden-rules-for-scaling"]], "The linear layer": [[2, "the-linear-layer"]], "Three golden rules": [[2, "three-golden-rules"]], "Fixing width scaling": [[2, "fixing-width-scaling"]], "Fixing depth scaling": [[2, "fixing-depth-scaling"]], "Fixing key-query dot product scaling": [[2, "fixing-key-query-dot-product-scaling"]], "Wrapping up": [[2, "wrapping-up"]], "The science of scale": [[3, "the-science-of-scale"]], "Warning": [[3, null], [5, null], [6, null], [7, null], [8, null], [9, null], [10, null], [11, null], [12, null], [13, null], [14, null]], "Pre-history": [[3, "pre-history"]], "\u03bcP enters the chat": [[3, "p-enters-the-chat"]], "Truth and reconciliation": [[3, "truth-and-reconciliation"]], "Automation of training": [[3, "automation-of-training"]], "Welcome to the Modula docs!": [[4, "welcome-to-the-modula-docs"]], "Purpose of the docs": [[4, "purpose-of-the-docs"]], "Navigating the docs": [[4, "navigating-the-docs"]], "Companion paper": [[4, "companion-paper"]], "Acknowledgements": [[4, "acknowledgements"]], "Conv2d": [[5, "conv2d"]], "Embedding": [[6, "embedding"]], "Atomic modules": [[7, "atomic-modules"]], "Linear": [[8, "linear"]], "Bond modules": [[9, "bond-modules"]], "Nonlinearities": [[10, "nonlinearities"]], "GPT": [[11, "gpt"]], "Compound modules": [[12, "compound-modules"]], "Modules": [[13, "modules"]], "Vectors": [[14, "vectors"]]}, "indexentries": {}})